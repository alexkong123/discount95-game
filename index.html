<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>95æ•¸èƒŒæ•¸å°æ¸¸æˆ² - å„ªåŒ–ç‰ˆ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'PingFang SC', 'Microsoft JhengHei', 'Segoe UI', sans-serif;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

body {
  overscroll-behavior: none;
  height: 100vh;
  color: #333;
  overflow: hidden;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

#fullscreen-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
}

.container {
  width: 100%;
  height: 100vh;
  max-width: 500px;
  margin: 0 auto;
  background: rgba(255, 255, 255, 0.98);
  border-radius: 0;
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.15);
  position: relative;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* å„ªåŒ–é ­éƒ¨å€åŸŸ */
.header {
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  padding: 15px 15px 10px;
  color: white;
  text-align: center;
  border-bottom-left-radius: 20px;
  border-bottom-right-radius: 20px;
  box-shadow: 0 4px 20px rgba(106, 17, 203, 0.3);
  position: relative;
  z-index: 10;
  min-height: 80px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.header h1 {
  font-size: 1.4rem;
  margin-bottom: 3px;
  font-weight: 700;
  letter-spacing: 0.5px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.subtitle {
  font-size: 0.75rem;
  opacity: 0.9;
  font-weight: 400;
}

.screen {
  display: none;
  flex: 1;
  flex-direction: column;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.active {
  display: flex;
}

/* æ§åˆ¶æŒ‰éˆ• */
.control-icons {
  position: absolute;
  top: 15px;
  right: 10px;
  display: flex;
  gap: 8px;
  z-index: 100;
}

.icon-btn {
  width: 36px;
  height: 36px;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  transition: all 0.3s;
  font-size: 0.9rem;
}

.icon-btn:active {
  transform: scale(0.95);
}

.back-btn {
  position: absolute;
  top: 15px;
  left: 10px;
  width: 36px;
  height: 36px;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  z-index: 100;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.back-btn:active {
  transform: scale(0.95);
}

/* é¦–é å„ªåŒ– */
.home-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 10px 15px;
}

.instructions {
  background: linear-gradient(135deg, #f5f7fa 0%, #e4e7f0 100%);
  padding: 12px;
  border-radius: 12px;
  margin: 10px 0 15px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border-left: 4px solid #6a11cb;
}

.instructions h3 {
  display: flex;
  align-items: center;
  gap: 8px;
  color: #6a11cb;
  margin-bottom: 8px;
  font-size: 0.95rem;
}

.instructions p {
  margin: 5px 0;
  font-size: 0.8rem;
  color: #555;
  line-height: 1.4;
}

.mode-card {
  background: white;
  border-radius: 14px;
  padding: 15px 12px;
  margin: 8px 0;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border: 2px solid transparent;
  position: relative;
  overflow: hidden;
}

.mode-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #6a11cb, #2575fc);
}

.mode-card:active {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.mode-card h2 {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  color: #333;
  font-size: 1.1rem;
  margin-bottom: 5px;
}

.mode-card p {
  color: #666;
  font-size: 0.8rem;
  text-align: center;
}

.footer-note {
  text-align: center;
  padding: 12px;
  font-size: 0.75rem;
  color: #888;
  border-top: 1px solid #eee;
  margin-top: auto;
}

/* éŠæˆ²ç•Œé¢å„ªåŒ– - ç·Šæ¹Šä½ˆå±€ */
.game-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 0 15px 15px;
  overflow: hidden;
}

.progress-container {
  background: white;
  padding: 12px 15px;
  border-radius: 12px;
  margin: 12px 0 10px;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
  flex-shrink: 0;
}

.progress-text {
  display: flex;
  justify-content: space-between;
  margin-bottom: 6px;
  font-size: 0.85rem;
  color: #555;
}

.progress-bar {
  height: 6px;
  background: #f0f0f0;
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 6px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #6a11cb, #2575fc);
  border-radius: 3px;
  transition: width 0.4s ease;
}

.timer-display {
  text-align: center;
  font-size: 0.8rem;
  color: #666;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
}

.question-container {
  background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
  border-radius: 16px;
  padding: 20px 12px;
  margin: 10px 0 15px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  border: 2px solid #e8e8e8;
  flex-shrink: 0;
}

.question {
  font-size: 3rem;
  font-weight: 800;
  color: #2c3e50;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  font-family: 'Arial', sans-serif;
  line-height: 1;
}

.answer-input-container {
  position: relative;
  margin: 12px 0 18px;
  flex-shrink: 0;
}

.answer-input {
  width: 100%;
  padding: 16px 20px;
  font-size: 1.8rem;
  text-align: center;
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 14px;
  color: #2c3e50;
  transition: all 0.3s;
  outline: none;
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.05);
  font-weight: 600;
  line-height: 1;
}

.answer-input:focus {
  border-color: #6a11cb;
  box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2);
}

/* å„ªåŒ–æ•¸å­—éµç›¤ - ç¾è§€ä¸”èˆ’é©çš„å°ºå¯¸ */
.keypad-container {
  background: white;
  border-radius: 20px;
  padding: 15px;
  margin-top: 5px;
  box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.08);
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.keypad {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-bottom: 12px;
  flex: 1;
  min-height: 0;
}

.key {
  background: linear-gradient(135deg, #f5f7fa 0%, #e4e7f0 100%);
  border: none;
  border-radius: 12px;
  font-size: 1.8rem;
  font-weight: 600;
  color: #2c3e50;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  user-select: none;
  min-height: 0;
  /* èª¿æ•´å¯¬åº¦è¨­ç½®ï¼Œç¢ºä¿å®¹æ˜“é»æ“Š */
  min-width: 0;
  height: 0;
  padding-bottom: 32%; /* å¢åŠ å¯¬åº¦æ¯”ä¾‹ */
  position: relative;
}

.key > span {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 1.8rem;
  font-weight: 600;
}

.key i {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 1.4rem;
}

.key:active {
  transform: scale(0.95);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  background: linear-gradient(135deg, #e4e7f0 0%, #d5d9e6 100%);
}

.key-controls {
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
  margin-top: 10px;
  flex-shrink: 0;
}

.control-btn {
  height: 48px;
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  border: none;
  border-radius: 12px;
  color: white;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  box-shadow: 0 4px 12px rgba(106, 17, 203, 0.3);
  flex-shrink: 0;
}

.control-btn:active {
  transform: translateY(2px);
  box-shadow: 0 2px 6px rgba(106, 17, 203, 0.3);
}

.control-btn.next-btn {
  background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
  box-shadow: 0 4px 12px rgba(0, 176, 155, 0.3);
}

/* çµæœé é¢å„ªåŒ– */
.result-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 0 15px 15px;
  overflow-y: auto;
}

.result-card {
  background: white;
  border-radius: 18px;
  padding: 18px;
  margin: 10px 0 15px;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  text-align: center;
  border: 2px solid #f0f0f0;
  flex-shrink: 0;
}

.result-badge {
  font-size: 2.5rem;
  margin: 8px 0 12px;
  animation: bounceIn 0.8s ease;
}

@keyframes bounceIn {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.05); }
  70% { transform: scale(0.9); }
  100% { transform: scale(1); opacity: 1; }
}

.score-display {
  font-size: 2rem;
  font-weight: 800;
  margin: 12px 0;
  color: #2c3e50;
}

.score-display span {
  color: #6a11cb;
}

.accuracy-display {
  font-size: 1.1rem;
  color: #666;
  margin-bottom: 12px;
}

.player-info {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 12px;
  margin: 12px 0;
  text-align: left;
}

.player-info-item {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
  border-bottom: 1px solid #eee;
  font-size: 0.9rem;
}

.player-info-item:last-child {
  border-bottom: none;
}

/* éŒ¯é¡Œå±•ç¤ºå„ªåŒ– */
.incorrect-container {
  background: white;
  border-radius: 18px;
  padding: 15px;
  margin: 12px 0;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
  flex-shrink: 0;
}

.incorrect-title {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  color: #e74c3c;
  font-weight: 600;
  font-size: 0.95rem;
}

.incorrect-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
}

.incorrect-item {
  background: #fff5f5;
  border-radius: 10px;
  padding: 12px;
  border: 2px solid #ffcccc;
  text-align: center;
  font-size: 0.9rem;
}

.incorrect-question {
  font-size: 1.3rem;
  font-weight: 700;
  color: #e74c3c;
  margin-bottom: 6px;
  line-height: 1;
}

.incorrect-answer {
  font-size: 1rem;
  color: #666;
  margin: 4px 0;
}

.incorrect-correct {
  font-size: 0.9rem;
  color: #27ae60;
  font-weight: 600;
  margin-top: 4px;
}

.incorrect-empty {
  text-align: center;
  padding: 25px 15px;
  background: #f8fff8;
  border-radius: 12px;
  border: 2px dashed #2ecc71;
  font-size: 0.9rem;
}

.incorrect-empty i {
  font-size: 2.5rem;
  color: #2ecc71;
  margin-bottom: 10px;
}

/* æŒ‰éˆ•çµ„ */
.button-group {
  display: flex;
  gap: 10px;
  margin-top: 15px;
  flex-shrink: 0;
}

.btn {
  flex: 1;
  padding: 14px;
  border: none;
  border-radius: 10px;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
}

.btn.primary {
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  color: white;
}

.btn.secondary {
  background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
  color: white;
}

.btn:active {
  transform: translateY(2px);
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
}

/* é›£åº¦é¸æ“‡å„ªåŒ– - ç¸®å°æŒ‘æˆ°æ¨¡å¼é¸é … */
.difficulty-grid {
  display: grid;
  gap: 10px; /* æ¸›å°‘é–“è· */
  margin: 15px 0;
  flex: 1;
  overflow-y: auto;
  padding: 5px 0;
}

.difficulty-card {
  background: white;
  border-radius: 14px;
  padding: 16px; /* æ¸›å°‘å…§é‚Šè· */
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  text-align: center;
}

.difficulty-card:active {
  transform: translateY(-2px);
  border-color: #6a11cb;
  box-shadow: 0 6px 16px rgba(106, 17, 203, 0.15);
}

.difficulty-card h3 {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 6px; /* æ¸›å°‘ä¸‹é‚Šè· */
  color: #333;
  font-size: 1rem; /* ç¸®å°å­—é«” */
}

.difficulty-card p {
  color: #666;
  font-size: 0.8rem; /* ç¸®å°å­—é«” */
  line-height: 1.3;
}

/* æš±ç¨±è¼¸å…¥å„ªåŒ– - ç¸®å°ç¢ºèªæŒ‰éˆ• */
.nickname-card {
  background: white;
  border-radius: 18px;
  padding: 25px 18px;
  margin: 20px 0;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  text-align: center;
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.nickname-input {
  width: 100%;
  padding: 16px;
  font-size: 1.1rem;
  text-align: center;
  background: #f8f9fa;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  margin: 15px 0;
  outline: none;
  transition: all 0.3s;
}

.nickname-input:focus {
  border-color: #6a11cb;
  background: white;
}

/* ç¸®å°æš±ç¨±ç¢ºèªæŒ‰éˆ• */
#confirm-nickname-btn {
  padding: 12px 20px; /* æ¸›å°‘å…§é‚Šè· */
  font-size: 0.95rem; /* ç¸®å°å­—é«” */
  height: auto;
  margin-top: 10px;
}

/* æŒ‘æˆ°æ¨¡å¼è¨ˆæ™‚å™¨ */
.challenge-timer {
  background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
  color: white;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin: 5px auto;
  box-shadow: 0 3px 12px rgba(255, 65, 108, 0.3);
}

/* å‹•ç•«æ•ˆæœ */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.screen.active {
  animation: fadeIn 0.4s ease;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.pulse {
  animation: pulse 0.3s ease;
}

/* éŸ¿æ‡‰å¼å„ªåŒ– - å°å±å¹•é€²ä¸€æ­¥å„ªåŒ– */
@media (max-width: 480px) {
  .container {
    max-width: 100%;
    border-radius: 0;
  }
  
  .header {
    padding: 12px 10px 8px;
    min-height: 70px;
  }
  
  .header h1 {
    font-size: 1.2rem;
  }
  
  .subtitle {
    font-size: 0.7rem;
  }
  
  .question {
    font-size: 2.6rem;
  }
  
  .keypad {
    gap: 8px;
  }
  
  .key > span {
    font-size: 1.6rem;
  }
  
  .key i {
    font-size: 1.2rem;
  }
  
  .key {
    padding-bottom: 34%; /* åœ¨å°å±å¹•ä¸Šå¢åŠ å¯¬åº¦ */
  }
  
  .answer-input {
    padding: 14px;
    font-size: 1.6rem;
  }
  
  .control-btn {
    height: 44px;
    font-size: 1rem;
  }
  
  .incorrect-grid {
    grid-template-columns: 1fr;
  }
  
  .button-group {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
    padding: 12px;
    font-size: 0.9rem;
  }
  
  .icon-btn, .back-btn {
    width: 32px;
    height: 32px;
    font-size: 0.8rem;
  }
  
  .game-content {
    padding: 0 12px 12px;
  }
  
  /* åœ¨å°å±å¹•ä¸Šé€²ä¸€æ­¥ç¸®å°æŒ‘æˆ°æ¨¡å¼é¸é … */
  .difficulty-card {
    padding: 14px 12px;
  }
  
  .difficulty-card h3 {
    font-size: 0.95rem;
  }
  
  .difficulty-card p {
    font-size: 0.75rem;
  }
  
  /* ç¸®å°æš±ç¨±ç¢ºèªæŒ‰éˆ• */
  #confirm-nickname-btn {
    padding: 10px 16px;
    font-size: 0.9rem;
  }
}

@media (max-width: 360px) {
  .header h1 {
    font-size: 1.1rem;
  }
  
  .question {
    font-size: 2.4rem;
  }
  
  .key > span {
    font-size: 1.5rem;
  }
  
  .keypad {
    gap: 6px;
  }
  
  .key {
    padding-bottom: 36%; /* åœ¨æ›´å°çš„å±å¹•ä¸Šé€²ä¸€æ­¥å¢åŠ å¯¬åº¦ */
  }
  
  .control-btn {
    font-size: 0.95rem;
    height: 42px;
  }
  
  .mode-card, .difficulty-card {
    padding: 12px 10px;
  }
  
  .mode-card h2 {
    font-size: 1rem;
  }
  
  .difficulty-card h3 {
    font-size: 0.9rem;
  }
  
  .difficulty-card p {
    font-size: 0.7rem;
  }
}

/* éŠæˆ²é é¢å°ˆç”¨ä½ˆå±€å„ªåŒ– - ç¢ºä¿ä¸ç”¨æ»¾å‹• */
#game-screen .game-content {
  padding-bottom: 10px;
}

#game-screen .question {
  font-size: 3rem;
}

/* å¾®ä¿¡å„ªåŒ– */
@media (max-width: 500px) {
  body {
    -webkit-touch-callout: none;
    -webkit-text-size-adjust: none;
  }
  
  .container {
    height: 100vh;
    min-height: -webkit-fill-available;
  }
  
  .key {
    touch-action: manipulation;
  }
}

/* é˜²æ­¢iOSç¼©æ”¾ */
@supports (-webkit-touch-callout: none) {
  body {
    min-height: -webkit-fill-available;
  }
}

/* éŠæˆ²é é¢ç‰¹å®šé«˜åº¦æ§åˆ¶ */
#game-screen {
  padding: 0;
}

#game-screen .header {
  flex-shrink: 0;
}

#game-screen .game-content {
  flex: 1;
  overflow: hidden;
}

#game-screen .keypad-container {
  flex: 1;
  min-height: 0;
}

/* ç¢ºä¿æ•¸å­—æŒ‰éµæ›´å®¹æ˜“é»æ“Š */
.key {
  min-width: 60px; /* ç¢ºä¿æœ€å°å¯¬åº¦ */
  min-height: 60px; /* ç¢ºä¿æœ€å°é«˜åº¦ */
}

@media (max-width: 480px) {
  .key {
    min-width: 55px;
    min-height: 55px;
  }
}

@media (max-width: 360px) {
  .key {
    min-width: 50px;
    min-height: 50px;
  }
}
</style>
</head>
<body>

<div id="fullscreen-container">
  <div class="container">
    <!-- æ§åˆ¶æŒ‰éˆ• -->
    <div class="control-icons">
      <div class="icon-btn" id="sound-toggle">
        <i class="fas fa-volume-up" id="sound-icon"></i>
      </div>
      <div class="icon-btn" id="bgm-toggle">
        <i class="fas fa-music" id="bgm-icon"></i>
      </div>
    </div>

    <!-- é¦–é  -->
    <div id="home-screen" class="screen active">
      <div class="back-btn" id="back-home-nickname" style="display: none;">
        <i class="fas fa-arrow-left"></i>
      </div>
      
      <div class="header">
        <h1><i class="fas fa-calculator"></i> 95æ•¸èƒŒæ•¸å°æ¸¸æˆ²</h1>
        <div class="subtitle">æå‡å¿ƒç®—èƒ½åŠ› Â· è¨“ç·´å¿«é€Ÿåæ‡‰</div>
      </div>
      
      <div class="home-content">
        <div class="instructions">
          <h3><i class="fas fa-info-circle"></i> éŠæˆ²èªªæ˜</h3>
          <p>1. éš¨æ©Ÿå‡ºç¾100-9900çš„æ•´ç™¾ä½æ•¸</p>
          <p>2. å¿«é€Ÿè¼¸å…¥è©²æ•¸çš„95æ•¸çµæœ</p>
          <p>3. ä½¿ç”¨ä¸‹æ–¹æ•¸å­—éµç›¤è¼¸å…¥ç­”æ¡ˆ</p>
          <p>4. å®Œæˆæ‰€æœ‰é¡Œç›®å¾Œå¯æŸ¥çœ‹æˆç¸¾å’ŒéŒ¯é¡Œ</p>
          <p style="color: #6a11cb; font-weight: 600;">ç¤ºä¾‹ï¼š100 â†’ 95ï¼Œ200 â†’ 190</p>
          <p style="margin-top: 10px; font-size: 0.75rem; color: #888;">é¸æ“‡ç·´ç¿’æ¨¡å¼å¯ä»¥è‡ªç”±ç·´ç¿’ï¼ŒæŒ‘æˆ°æ¨¡å¼å‰‡æœ‰æ™‚é–“é™åˆ¶</p>
        </div>
        
        <div class="mode-card" id="practice-mode">
          <h2><i class="fas fa-book-open"></i> ç·´ç¿’æ¨¡å¼</h2>
          <p>ç„¡æ™‚é–“å£“åŠ›ï¼Œè‡ªç”±ç·´ç¿’å¿ƒç®—èƒ½åŠ›</p>
        </div>
        
        <div class="mode-card" id="challenge-mode">
          <h2><i class="fas fa-trophy"></i> æŒ‘æˆ°æ¨¡å¼</h2>
          <p>é™æ™‚æŒ‘æˆ°ï¼Œæ¸¬è©¦ä½ çš„åæ‡‰é€Ÿåº¦</p>
        </div>
        
        <div class="footer-note">
          <i class="fas fa-mobile-alt"></i> å„ªåŒ–é©é…å¾®ä¿¡ç€è¦½å™¨
        </div>
      </div>
    </div>

    <!-- æš±ç¨±è¼¸å…¥é  -->
    <div id="nickname-screen" class="screen">
      <div class="back-btn" id="back-home-nickname-btn">
        <i class="fas fa-arrow-left"></i>
      </div>
      
      <div class="header">
        <h1><i class="fas fa-user"></i> è¼¸å…¥ç©å®¶æš±ç¨±</h1>
        <div class="subtitle">è«‹è¼¸å…¥æ‚¨çš„æš±ç¨±æˆ–IDï¼Œå°‡é¡¯ç¤ºåœ¨æˆç¸¾å–®ä¸Š</div>
      </div>
      
      <div class="nickname-card">
        <div style="margin-bottom: 15px;">
          <i class="fas fa-user-circle" style="font-size: 3rem; color: #6a11cb;"></i>
        </div>
        
        <input type="text" class="nickname-input" id="nickname-input" 
               placeholder="è«‹è¼¸å…¥æš±ç¨± (2-10å€‹å­—ç¬¦)" maxlength="10">
        
        <div style="color: #888; font-size: 0.8rem; margin-bottom: 15px;">
          <i class="fas fa-info-circle"></i> æš±ç¨±å°‡é¡¯ç¤ºåœ¨æˆç¸¾å–®ä¸Šï¼Œå¯ä½¿ç”¨ä¸­æ–‡ã€è‹±æ–‡æˆ–æ•¸å­—
        </div>
        
        <button class="btn primary" id="confirm-nickname-btn">
          <i class="fas fa-check"></i> ç¢ºèªä¸¦ç¹¼çºŒ
        </button>
      </div>
    </div>

    <!-- ç·´ç¿’æ¨¡å¼é¸æ“‡é  -->
    <div id="practice-screen" class="screen">
      <div class="back-btn" id="back-home-practice">
        <i class="fas fa-arrow-left"></i>
      </div>
      
      <div class="header">
        <h1><i class="fas fa-book-open"></i> ç·´ç¿’æ¨¡å¼</h1>
        <div class="subtitle">é¸æ“‡ç·´ç¿’æ•¸å€¼ç¯„åœ</div>
      </div>
      
      <div class="difficulty-grid">
        <div class="difficulty-card" data-range="1">
          <h3><i class="fas fa-layer-group"></i> 100è‡³1900å…§å®¹</h3>
        </div>
        
        <div class="difficulty-card" data-range="2">
          <h3><i class="fas fa-layer-group"></i> 2100è‡³3900å…§å®¹</h3>
        </div>
        
        <div class="difficulty-card" data-range="3">
          <h3><i class="fas fa-layer-group"></i> 4100è‡³5900å…§å®¹</h3>
        </div>
        
        <div class="difficulty-card" data-range="4">
          <h3><i class="fas fa-layer-group"></i> 6100è‡³7900å…§å®¹</h3>
        </div>
        
        <div class="difficulty-card" data-range="5">
          <h3><i class="fas fa-layer-group"></i> 8100è‡³9900å…§å®¹</h3>
        </div>
        
        <div class="difficulty-card" data-range="6">
          <h3><i class="fas fa-layer-group"></i> 100è‡³4900å…§å®¹</h3>
        </div>
        
        <div class="difficulty-card" data-range="7">
          <h3><i class="fas fa-layer-group"></i> 5100è‡³9900å…§å®¹</h3>
        </div>
      </div>
    </div>

    <!-- æŒ‘æˆ°æ¨¡å¼é¸æ“‡é  -->
    <div id="challenge-screen" class="screen">
      <div class="back-btn" id="back-home-challenge">
        <i class="fas fa-arrow-left"></i>
      </div>
      
      <div class="header">
        <h1><i class="fas fa-trophy"></i> æŒ‘æˆ°æ¨¡å¼</h1>
        <div class="subtitle">é¸æ“‡æŒ‘æˆ°é›£åº¦</div>
      </div>
      
      <div class="difficulty-grid">
        <div class="difficulty-card" data-difficulty="basic">
          <h3><i class="fas fa-star"></i> åŸºç¤æŒ‘æˆ°</h3>
          <p>10ç§’/é¡Œ Â· 30é¡Œ Â· é©åˆæ–°æ‰‹</p>
        </div>
        
        <div class="difficulty-card" data-difficulty="advanced">
          <h3><i class="fas fa-star-half-alt"></i> é€²éšæŒ‘æˆ°</h3>
          <p>7ç§’/é¡Œ Â· 50é¡Œ Â· ä¸­ç­‰é›£åº¦</p>
        </div>
        
        <div class="difficulty-card" data-difficulty="expert">
          <h3><i class="fas fa-star"></i> å°ˆå®¶æŒ‘æˆ°</h3>
          <p>5ç§’/é¡Œ Â· 99é¡Œ Â· é«˜æ‰‹å°ˆå±¬</p>
        </div>
      </div>
    </div>

    <!-- éŠæˆ²é  -->
    <div id="game-screen" class="screen">
      <div class="back-btn" id="back-home-game">
        <i class="fas fa-home"></i>
      </div>
      
      <div class="header">
        <h1 id="game-title">95æ•¸èƒŒæ•¸å°æ¸¸æˆ²</h1>
        <div id="challenge-timer-container" style="display: none;">
          <div class="challenge-timer">
            <i class="fas fa-clock"></i> å‰©é¤˜æ™‚é–“: <span id="challenge-timer">10</span>ç§’
          </div>
        </div>
      </div>
      
      <div class="game-content">
        <div class="progress-container">
          <div class="progress-text">
            <span>ç¬¬ <span id="current-question">1</span> é¡Œ</span>
            <span>å…± <span id="total-questions">10</span> é¡Œ</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
          </div>
          <div class="timer-display">
            <i class="fas fa-clock"></i> ç”¨æ™‚: <span id="timer">00:00</span>
          </div>
        </div>
        
        <div class="question-container">
          <div class="question" id="question">100</div>
        </div>
        
        <div class="answer-input-container">
          <input type="text" class="answer-input" id="answer-input" placeholder="è¼¸å…¥95æ•¸ç­”æ¡ˆ" readonly>
        </div>
        
        <div class="keypad-container">
          <div class="keypad">
            <button class="key"><span>1</span></button>
            <button class="key"><span>2</span></button>
            <button class="key"><span>3</span></button>
            <button class="key"><span>4</span></button>
            <button class="key"><span>5</span></button>
            <button class="key"><span>6</span></button>
            <button class="key"><span>7</span></button>
            <button class="key"><span>8</span></button>
            <button class="key"><span>9</span></button>
            <button class="key" id="backspace"><i class="fas fa-backspace"></i></button>
            <button class="key"><span>0</span></button>
            <button class="key" id="clear"><i class="fas fa-trash-alt"></i></button>
          </div>
          
          <div class="key-controls">
            <button class="control-btn next-btn" id="next-btn">
              <i class="fas fa-arrow-right"></i> ä¸‹ä¸€é¡Œ
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- çµæœé  -->
    <div id="result-screen" class="screen">
      <div class="back-btn" id="back-home-result">
        <i class="fas fa-home"></i>
      </div>
      
      <div class="header">
        <h1>æŒ‘æˆ°å®Œæˆï¼</h1>
        <div class="subtitle">æŸ¥çœ‹ä½ çš„æˆç¸¾è¡¨ç¾</div>
      </div>
      
      <div class="result-content">
        <div class="result-card">
          <div id="result-badge" class="result-badge">
            <i class="fas fa-trophy" style="color: #FFD700;"></i>
          </div>
          
          <div class="score-display">
            <span id="score">0</span> / <span id="total">10</span>
          </div>
          
          <div class="accuracy-display">
            æ­£ç¢ºç‡ï¼š<span id="accuracy" style="color: #e74c3c; font-weight: 700;">0</span>%
          </div>
          
          <div class="player-info">
            <div class="player-info-item">
              <span><i class="fas fa-user"></i> ç©å®¶æš±ç¨±ï¼š</span>
              <span id="result-nickname" style="font-weight: 600;">æœªè¨­å®š</span>
            </div>
            <div class="player-info-item">
              <span><i class="fas fa-gamepad"></i> éŠæˆ²æ¨¡å¼ï¼š</span>
              <span id="result-mode" style="font-weight: 600;">ç·´ç¿’æ¨¡å¼</span>
            </div>
            <div class="player-info-item">
              <span><i class="fas fa-layer-group"></i> é¸æ“‡é …ç›®ï¼š</span>
              <span id="result-difficulty" style="font-weight: 600;">100-1900ç¯„åœ</span>
            </div>
            <div class="player-info-item">
              <span><i class="fas fa-clock"></i> ç¸½ç”¨æ™‚ï¼š</span>
              <span id="total-time" style="font-weight: 600;">00:00</span>
            </div>
          </div>
          
          <div id="challenge-result" style="display: none; margin-top: 12px;">
            <div style="color: #666; font-size: 0.85rem;">
              <i class="fas fa-stopwatch"></i> å¹³å‡ç­”é¡Œæ™‚é–“: <span id="avg-time">0</span>ç§’
            </div>
          </div>
        </div>
        
        <div class="incorrect-container">
          <div class="incorrect-title">
            <span><i class="fas fa-exclamation-triangle"></i> éŒ¯é¡Œè¨˜éŒ„</span>
            <span id="incorrect-count">0</span>é¡Œ
          </div>
          
          <div id="incorrect-grid">
            <!-- é€™è£¡æœƒå‹•æ…‹ç”ŸæˆéŒ¯é¡Œæ–¹æ ¼ -->
          </div>
          
          <div id="incorrect-empty" class="incorrect-empty" style="display: none;">
            <i class="fas fa-check-circle"></i>
            <p style="margin-top: 10px; font-size: 0.9rem;">å¤ªæ£’äº†ï¼å…¨éƒ¨ç­”å°ï¼ğŸ‰</p>
          </div>
        </div>
        
        <div class="button-group">
          <button class="btn primary" id="restart-btn">
            <i class="fas fa-redo"></i> å†ç©ä¸€æ¬¡
          </button>
          <button class="btn secondary" id="share-btn">
            <i class="fab fa-weixin"></i> åˆ†äº«æˆç¸¾
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- èƒŒæ™¯éŸ³æ¨‚æ’­æ”¾å™¨ -->
<audio id="bg-music" loop>
  <source src="https://github.com/alexkong123/bg-music-repo/raw/refs/heads/main/ElevateMusica-%20%5BCopyright%20Safe%20Background%20Music%5D.mp3" type="audio/mpeg">
</audio>

<script>
// éŠæˆ²é‚è¼¯
const gameState = {
  playerName: 'ç©å®¶',
  mode: null,
  difficulty: null,
  practiceRange: null,
  totalQuestions: 18,
  currentQuestion: 1,
  score: 0,
  questions: [],
  userAnswers: [],
  correctAnswers: [],
  incorrectList: [],
  startTime: null,
  timerInterval: null,
  challengeTimerInterval: null,
  elapsedTime: 0,
  challengeTimeLeft: 0,
  usedNumbers: new Set(),
  challengeTimes: []
};

// ç·´ç¿’ç¯„åœå®šç¾©
const practiceRanges = {
  1: { min: 100, max: 1900, name: "100è‡³1900å…§å®¹" },
  2: { min: 2100, max: 3900, name: "2100è‡³3900å…§å®¹" },
  3: { min: 4100, max: 5900, name: "4100è‡³5900å…§å®¹" },
  4: { min: 6100, max: 7900, name: "6100è‡³7900å…§å®¹" },
  5: { min: 8100, max: 9900, name: "8100è‡³9900å…§å®¹" },
  6: { min: 100, max: 4900, name: "100è‡³4900å…§å®¹" },
  7: { min: 5100, max: 9900, name: "5100è‡³9900å…§å®¹" }
};

// å±å¹•å®šç¾©
const screens = {
  home: document.getElementById('home-screen'),
  nickname: document.getElementById('nickname-screen'),
  practice: document.getElementById('practice-screen'),
  challenge: document.getElementById('challenge-screen'),
  game: document.getElementById('game-screen'),
  result: document.getElementById('result-screen')
};

// é¡¯ç¤ºå±å¹•
function showScreen(screen) {
  Object.values(screens).forEach(s => s.classList.remove('active'));
  screen.classList.add('active');
}

// è¿”å›é¦–é 
function goToHomeScreen() {
  clearInterval(gameState.timerInterval);
  clearInterval(gameState.challengeTimerInterval);
  showScreen(screens.home);
}

// ä¸»ç•Œé¢æ¨¡å¼é¸æ“‡
document.getElementById('practice-mode').addEventListener('click', function() {
  gameState.mode = 'practice';
  showScreen(screens.nickname);
});

document.getElementById('challenge-mode').addEventListener('click', function() {
  gameState.mode = 'challenge';
  showScreen(screens.nickname);
});

// æš±ç¨±ç¢ºèªæŒ‰éˆ•
document.getElementById('confirm-nickname-btn').addEventListener('click', function() {
  const nicknameInput = document.getElementById('nickname-input');
  const nickname = nicknameInput.value.trim();
  
  if (nickname.length < 2 || nickname.length > 10) {
    alert('è«‹è¼¸å…¥2-10å€‹å­—ç¬¦çš„æš±ç¨±');
    return;
  }
  
  gameState.playerName = nickname;
  
  // æ ¹æ“šé¸æ“‡çš„æ¨¡å¼é€²å…¥ç›¸æ‡‰çš„é¸æ“‡é é¢
  if (gameState.mode === 'practice') {
    showScreen(screens.practice);
  } else {
    showScreen(screens.challenge);
  }
});

// è¿”å›æŒ‰éˆ•äº‹ä»¶
document.getElementById('back-home-nickname-btn').addEventListener('click', goToHomeScreen);
document.getElementById('back-home-practice').addEventListener('click', function() {
  showScreen(screens.nickname);
});
document.getElementById('back-home-challenge').addEventListener('click', function() {
  showScreen(screens.nickname);
});
document.getElementById('back-home-game').addEventListener('click', goToHomeScreen);
document.getElementById('back-home-result').addEventListener('click', goToHomeScreen);

// ç·´ç¿’æ¨¡å¼é¸æ“‡
document.querySelectorAll('#practice-screen .difficulty-card').forEach(option => {
  option.addEventListener('click', function() {
    gameState.practiceRange = parseInt(this.dataset.range);
    startGame();
  });
});

// æŒ‘æˆ°æ¨¡å¼é¸æ“‡
document.querySelectorAll('#challenge-screen .difficulty-card').forEach(option => {
  option.addEventListener('click', function() {
    gameState.difficulty = this.dataset.difficulty;
    switch(gameState.difficulty) {
      case 'basic':
        gameState.totalQuestions = 30;
        gameState.challengeTimeLeft = 10;
        break;
      case 'advanced':
        gameState.totalQuestions = 50;
        gameState.challengeTimeLeft = 7;
        break;
      case 'expert':
        gameState.totalQuestions = 99;
        gameState.challengeTimeLeft = 5;
        break;
    }
    startGame();
  });
});

// ç”Ÿæˆå•é¡Œ
function generateQuestions() {
  const questions = [];
  let allNumbers = [];
  
  if (gameState.mode === 'practice') {
    const range = practiceRanges[gameState.practiceRange];
    for (let num = range.min; num <= range.max; num += 100) {
      allNumbers.push(num);
    }
    gameState.totalQuestions = Math.min(18, allNumbers.length);
  } else {
    for (let num = 100; num <= 9900; num += 100) {
      allNumbers.push(num);
    }
    gameState.totalQuestions = Math.min(gameState.totalQuestions, allNumbers.length);
  }
  
  gameState.usedNumbers.clear();
  
  // æ´—ç‰Œç®—æ³•
  for (let i = allNumbers.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [allNumbers[i], allNumbers[j]] = [allNumbers[j], allNumbers[i]];
  }
  
  // å–å‰totalQuestionså€‹æ•¸å­—
  for (let i = 0; i < gameState.totalQuestions && i < allNumbers.length; i++) {
    const num = allNumbers[i];
    questions.push(num);
    gameState.usedNumbers.add(num);
  }
  
  return questions;
}

// è¨ˆç®—95æŠ˜
function calculate95Percent(number) {
  return Math.floor(number * 0.95);
}

// é–‹å§‹è¨ˆæ™‚å™¨
function startTimer() {
  gameState.startTime = new Date();
  gameState.timerInterval = setInterval(() => {
    const now = new Date();
    gameState.elapsedTime = Math.floor((now - gameState.startTime) / 1000);
    updateTimerDisplay();
  }, 1000);
}

// æŒ‘æˆ°æ¨¡å¼è¨ˆæ™‚å™¨
function startChallengeTimer() {
  document.getElementById('challenge-timer-container').style.display = 'block';
  document.getElementById('challenge-timer').textContent = gameState.challengeTimeLeft;
  
  const questionStartTime = new Date();
  gameState.challengeTimerInterval = setInterval(() => {
    gameState.challengeTimeLeft--;
    document.getElementById('challenge-timer').textContent = gameState.challengeTimeLeft;
    
    if (gameState.challengeTimeLeft <= 0) {
      clearInterval(gameState.challengeTimerInterval);
      const questionTime = Math.floor((new Date() - questionStartTime) / 1000);
      gameState.challengeTimes.push(questionTime);
      
      const userAnswer = document.getElementById('answer-input').value;
      if (!userAnswer) {
        gameState.userAnswers.push(null);
        gameState.correctAnswers.push(calculate95Percent(gameState.questions[gameState.currentQuestion - 1]));
        gameState.incorrectList.push({
          question: gameState.questions[gameState.currentQuestion - 1],
          userAnswer: null,
          correctAnswer: calculate95Percent(gameState.questions[gameState.currentQuestion - 1])
        });
      }
      
      nextQuestion();
    }
  }, 1000);
}

// æ›´æ–°è¨ˆæ™‚å™¨é¡¯ç¤º
function updateTimerDisplay() {
  const minutes = Math.floor(gameState.elapsedTime / 60).toString().padStart(2, '0');
  const seconds = (gameState.elapsedTime % 60).toString().padStart(2, '0');
  document.getElementById('timer').textContent = `${minutes}:${seconds}`;
}

// é–‹å§‹æ–°éŠæˆ²
function startGame() {
  clearInterval(gameState.timerInterval);
  clearInterval(gameState.challengeTimerInterval);
  
  gameState.currentQuestion = 1;
  gameState.score = 0;
  gameState.questions = generateQuestions();
  gameState.userAnswers = [];
  gameState.correctAnswers = [];
  gameState.incorrectList = [];
  gameState.elapsedTime = 0;
  gameState.challengeTimes = [];
  
  document.getElementById('current-question').textContent = '1';
  document.getElementById('total-questions').textContent = gameState.questions.length;
  document.getElementById('question').textContent = gameState.questions[0];
  document.getElementById('answer-input').value = '';
  document.getElementById('progress-fill').style.width = '0%';
  document.getElementById('next-btn').disabled = true;
  
  // è¨­ç½®éŠæˆ²æ¨™é¡Œ
  if (gameState.mode === 'challenge') {
    document.getElementById('game-title').innerHTML = `<i class="fas fa-trophy"></i> æŒ‘æˆ°æ¨¡å¼ - ${getDifficultyName()}`;
  } else {
    document.getElementById('game-title').textContent = "ç·´ç¿’æ¨¡å¼";
  }
  
  showScreen(screens.game);
  startTimer();
  updateProgressBar();
  
  if (gameState.mode === 'challenge') {
    startChallengeTimer();
  }
}

// ç²å–é›£åº¦åç¨±
function getDifficultyName() {
  switch(gameState.difficulty) {
    case 'basic': return 'åŸºç¤';
    case 'advanced': return 'é€²éš';
    case 'expert': return 'å°ˆå®¶';
    default: return '';
  }
}

// æ›´æ–°é€²åº¦æ¢
function updateProgressBar() {
  const progress = ((gameState.currentQuestion - 1) / gameState.questions.length) * 100;
  document.getElementById('progress-fill').style.width = `${progress}%`;
}

// ä¸‹ä¸€é¡Œ
function nextQuestion() {
  clearInterval(gameState.challengeTimerInterval);
  
  const userAnswer = document.getElementById('answer-input').value;
  
  if (gameState.mode === 'challenge') {
    const questionStartTime = gameState.startTime ? 
      gameState.startTime.getTime() + (gameState.elapsedTime * 1000) : new Date().getTime();
    const questionTime = Math.floor((new Date() - questionStartTime) / 1000);
    gameState.challengeTimes.push(questionTime);
  }
  
  if (userAnswer) {
    const currentNum = gameState.questions[gameState.currentQuestion - 1];
    const correctAnswer = calculate95Percent(currentNum);
    gameState.userAnswers.push(parseInt(userAnswer));
    gameState.correctAnswers.push(correctAnswer);
    
    if (parseInt(userAnswer) === correctAnswer) {
      gameState.score++;
      document.getElementById('answer-input').classList.add('pulse');
      document.getElementById('answer-input').style.backgroundColor = '#e8f5e9';
      setTimeout(() => {
        document.getElementById('answer-input').classList.remove('pulse');
      }, 300);
    } else {
      gameState.incorrectList.push({
        question: currentNum,
        userAnswer: parseInt(userAnswer),
        correctAnswer: correctAnswer
      });
      document.getElementById('answer-input').classList.add('pulse');
      document.getElementById('answer-input').style.backgroundColor = '#ffebee';
      setTimeout(() => {
        document.getElementById('answer-input').classList.remove('pulse');
      }, 300);
    }
  }
  
  // é€²å…¥ä¸‹ä¸€é¡Œ
  gameState.currentQuestion++;
  
  if (gameState.currentQuestion > gameState.questions.length) {
    endGame();
    return;
  }
  
  document.getElementById('current-question').textContent = gameState.currentQuestion;
  document.getElementById('question').textContent = gameState.questions[gameState.currentQuestion - 1];
  document.getElementById('answer-input').value = '';
  document.getElementById('answer-input').style.backgroundColor = '';
  updateProgressBar();
  document.getElementById('next-btn').disabled = true;
  
  // å¦‚æœæ˜¯æŒ‘æˆ°æ¨¡å¼ï¼Œé‡ç½®å€’è¨ˆæ™‚
  if (gameState.mode === 'challenge') {
    switch(gameState.difficulty) {
      case 'basic': gameState.challengeTimeLeft = 10; break;
      case 'advanced': gameState.challengeTimeLeft = 7; break;
      case 'expert': gameState.challengeTimeLeft = 5; break;
    }
    startChallengeTimer();
  }
}

// çµæŸéŠæˆ²
function endGame() {
  clearInterval(gameState.timerInterval);
  clearInterval(gameState.challengeTimerInterval);
  showResults();
}

// é¡¯ç¤ºçµæœ
function showResults() {
  const totalQuestions = gameState.questions.length;
  const accuracy = Math.round((gameState.score / totalQuestions) * 100);
  
  // æ›´æ–°ç©å®¶è³‡è¨Š
  document.getElementById('result-nickname').textContent = gameState.playerName;
  
  if (gameState.mode === 'practice') {
    document.getElementById('result-mode').textContent = "ç·´ç¿’æ¨¡å¼";
    const range = practiceRanges[gameState.practiceRange];
    document.getElementById('result-difficulty').textContent = range.name;
  } else {
    document.getElementById('result-mode').textContent = "æŒ‘æˆ°æ¨¡å¼";
    document.getElementById('result-difficulty').textContent = 
      gameState.difficulty === 'basic' ? 'åŸºç¤æŒ‘æˆ°' : 
      gameState.difficulty === 'advanced' ? 'é€²éšæŒ‘æˆ°' : 'å°ˆå®¶æŒ‘æˆ°';
  }
  
  // æ›´æ–°åˆ†æ•¸å’Œæ­£ç¢ºç‡
  document.getElementById('score').textContent = gameState.score;
  document.getElementById('total').textContent = totalQuestions;
  document.getElementById('accuracy').textContent = accuracy;
  
  // æ›´æ–°éŒ¯èª¤é¡Œæ•¸
  document.getElementById('incorrect-count').textContent = gameState.incorrectList.length;
  
  const minutes = Math.floor(gameState.elapsedTime / 60).toString().padStart(2, '0');
  const seconds = (gameState.elapsedTime % 60).toString().padStart(2, '0');
  document.getElementById('total-time').textContent = `${minutes}:${seconds}`;
  
  // æ›´æ–°çµæœå¾½ç« 
  const badge = document.getElementById('result-badge');
  if (accuracy >= 90) {
    badge.innerHTML = '<i class="fas fa-crown" style="color: #FFD700;"></i>';
    badge.title = "ç‹è€…ç´šåˆ¥ï¼";
  } else if (accuracy >= 70) {
    badge.innerHTML = '<i class="fas fa-star" style="color: #C0C0C0;"></i>';
    badge.title = "è¡¨ç¾å„ªç•°ï¼";
  } else if (accuracy >= 50) {
    badge.innerHTML = '<i class="fas fa-check-circle" style="color: #CD7F32;"></i>';
    badge.title = "ç¹¼çºŒåŠªåŠ›ï¼";
  } else {
    badge.innerHTML = '<i class="fas fa-redo" style="color: #8B4513;"></i>';
    badge.title = "å¤šåŠ ç·´ç¿’ï¼";
  }
  
  // æŒ‘æˆ°æ¨¡å¼é¡¯ç¤ºé¡å¤–ä¿¡æ¯
  const challengeResult = document.getElementById('challenge-result');
  if (gameState.mode === 'challenge' && gameState.challengeTimes.length > 0) {
    challengeResult.style.display = 'block';
    const avgTime = gameState.challengeTimes.reduce((a, b) => a + b, 0) / gameState.challengeTimes.length;
    document.getElementById('avg-time').textContent = avgTime.toFixed(1);
  } else {
    challengeResult.style.display = 'none';
  }
  
  // æ¸…ç©ºä¸¦é‡æ–°ç”ŸæˆéŒ¯èª¤è¨˜éŒ„
  const incorrectGrid = document.getElementById('incorrect-grid');
  const incorrectEmpty = document.getElementById('incorrect-empty');
  
  incorrectGrid.innerHTML = '';
  
  if (gameState.incorrectList.length === 0) {
    incorrectGrid.style.display = 'none';
    incorrectEmpty.style.display = 'flex';
  } else {
    incorrectGrid.style.display = 'grid';
    incorrectEmpty.style.display = 'none';
    
    gameState.incorrectList.forEach((item, index) => {
      const gridItem = document.createElement('div');
      gridItem.className = 'incorrect-item';
      gridItem.innerHTML = `
        <div style="font-size: 0.75rem; color: #999; margin-bottom: 3px;">ç¬¬ ${index + 1} é¡Œ</div>
        <div class="incorrect-question">${item.question}</div>
        <div style="font-size: 0.85rem; color: #666; margin: 3px 0;">æ‚¨çš„ç­”æ¡ˆ: ${item.userAnswer || 'æœªä½œç­”'}</div>
        <div class="incorrect-correct">æ­£ç¢º: ${item.correctAnswer}</div>
      `;
      incorrectGrid.appendChild(gridItem);
    });
  }
  
  showScreen(screens.result);
}

// æ•¸å­—éµç›¤è™•ç† - æ›´æ–°ç‚ºæ–°çš„HTMLçµæ§‹
document.querySelectorAll('.key:not(#backspace):not(#clear)').forEach(key => {
  key.addEventListener('click', () => {
    const answerInput = document.getElementById('answer-input');
    const number = key.querySelector('span');
    if (number) {
      answerInput.value += number.textContent;
      document.getElementById('next-btn').disabled = false;
    }
  });
});

document.getElementById('backspace').addEventListener('click', () => {
  const answerInput = document.getElementById('answer-input');
  answerInput.value = answerInput.value.slice(0, -1);
  document.getElementById('next-btn').disabled = answerInput.value === '';
});

document.getElementById('clear').addEventListener('click', () => {
  document.getElementById('answer-input').value = '';
  document.getElementById('next-btn').disabled = true;
});

// ä¸‹ä¸€é¡ŒæŒ‰éˆ•
document.getElementById('next-btn').addEventListener('click', nextQuestion);

// é‡æ–°é–‹å§‹
document.getElementById('restart-btn').addEventListener('click', () => {
  if (gameState.mode === 'practice') {
    showScreen(screens.practice);
  } else {
    showScreen(screens.challenge);
  }
});

// éµç›¤äº‹ä»¶
document.addEventListener('keydown', (e) => {
  if (e.key >= '0' && e.key <= '9') {
    const answerInput = document.getElementById('answer-input');
    answerInput.value += e.key;
    document.getElementById('next-btn').disabled = false;
  } else if (e.key === 'Backspace') {
    const answerInput = document.getElementById('answer-input');
    answerInput.value = answerInput.value.slice(0, -1);
    document.getElementById('next-btn').disabled = answerInput.value === '';
  } else if (e.key === 'Enter') {
    e.preventDefault();
    nextQuestion();
  }
});

// èƒŒæ™¯éŸ³æ¨‚ç³»çµ±
let bgmEnabled = true;
const bgmToggle = document.getElementById('bgm-toggle');
const bgmIcon = document.getElementById('bgm-icon');
const bgMusic = document.getElementById('bg-music');

function setupBackgroundMusic() {
  bgMusic.volume = 0.10;
  document.body.addEventListener('click', function initBGM() {
    if (bgmEnabled && bgMusic.paused) {
      bgMusic.play().catch(e => console.log('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', e));
    }
    document.body.removeEventListener('click', initBGM);
  });
}

setupBackgroundMusic();

bgmToggle.addEventListener('click', () => {
  bgmEnabled = !bgmEnabled;
  bgmIcon.className = bgmEnabled ? 'fas fa-music' : 'fas fa-music-slash';
  if (bgmEnabled) {
    bgMusic.play().catch(e => console.log('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', e));
  } else {
    bgMusic.pause();
  }
});

// éŸ³æ•ˆç³»çµ±
let soundEnabled = true;
const soundToggle = document.getElementById('sound-toggle');
const soundIcon = document.getElementById('sound-icon');

soundToggle.addEventListener('click', () => {
  soundEnabled = !soundEnabled;
  soundIcon.className = soundEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
});

// åˆ†äº«åŠŸèƒ½
document.getElementById('share-btn').addEventListener('click', function() {
  const accuracy = Math.round((gameState.score / gameState.questions.length) * 100);
  const timeMinutes = Math.floor(gameState.elapsedTime / 60);
  const timeSeconds = gameState.elapsedTime % 60;
  
  const shareText = `ç©å®¶ï¼š${gameState.playerName}
æˆ‘åœ¨95æ•¸èƒŒæ•¸éŠæˆ²ä¸­${gameState.mode === 'challenge' ? 'ã€æŒ‘æˆ°æ¨¡å¼ã€‘' : 'ã€ç·´ç¿’æ¨¡å¼ã€‘'}ç²å¾—${gameState.score}/${gameState.questions.length}åˆ†ï¼
æ­£ç¢ºç‡ï¼š${accuracy}%
ç”¨æ™‚ï¼š${timeMinutes}åˆ†${timeSeconds}ç§’
å¿«ä¾†æŒ‘æˆ°ä½ çš„å¿ƒç®—èƒ½åŠ›ï¼`;
  
  // å˜—è©¦ä½¿ç”¨Web Share API
  if (navigator.share) {
    navigator.share({
      title: '95æ•¸èƒŒæ•¸éŠæˆ²æˆç¸¾',
      text: shareText,
      url: window.location.href
    }).catch(console.error);
  } else {
    // è¤‡è£½åˆ°å‰ªè²¼æ¿
    navigator.clipboard.writeText(shareText).then(() => {
      alert('åˆ†äº«å…§å®¹å·²è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼\n\n' + shareText);
    }).catch(err => {
      console.error('è¤‡è£½å¤±æ•—:', err);
      alert('è«‹æ‰‹å‹•è¤‡è£½ä»¥ä¸‹å…§å®¹ï¼š\n\n' + shareText);
    });
  }
});

// åˆå§‹åŒ–æš±ç¨±è¼¸å…¥æ¡†
const nicknameInput = document.getElementById('nickname-input');
const savedNickname = localStorage.getItem('95game_nickname');
if (savedNickname) {
  nicknameInput.value = savedNickname;
}

// å„²å­˜æš±ç¨±åˆ°æœ¬åœ°å„²å­˜
nicknameInput.addEventListener('change', function() {
  if (this.value.trim().length >= 2) {
    localStorage.setItem('95game_nickname', this.value.trim());
  }
});

// æª¢æ¸¬æ˜¯å¦ç‚ºiOSè¨­å‚™
function isIOS() {
  return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
}

// è¨­ç½®bodyçš„overflowå±¬æ€§
if (isIOS()) {
  document.body.style.overflow = 'hidden';
} else {
  document.body.style.overflow = 'auto';
}

// è¼¸å…¥æ¡†äº‹ä»¶ç›£è½
const answerInput = document.getElementById('answer-input');
answerInput.addEventListener('input', function() {
  document.getElementById('next-btn').disabled = this.value === '';
});

console.log('éŠæˆ²åˆå§‹åŒ–å®Œæˆï¼æ‰€æœ‰æŒ‰éˆ•åŠŸèƒ½æ­£å¸¸ã€‚');
</script>
</body>
</html>
